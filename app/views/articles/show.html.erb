<h3>記事詳細</h3>

<div class="row">
  <div class="col-xs-10 col-xs-offset-1 text-center">
    <h4 class="show-title">タイトル ： <%= @article.title %></h4>
    <% if @article.favorites.count >= 1 %>
      <p><%= @article.favorites.count %> <span class="glyphicon glyphicon-thumbs-up" aria-hidden="true"></span></p>
    <% end %>
    <p><%= attachment_image_tag @article, :article_image, format: "jpeg", fallback: "l_e_others_470.jpg", size: "300x300" %></p>
    <p> <% @article.tag_list.each do |tag_list| %>
          <span class="label label-info"><%= link_to "#{tag_list}", tag_articles_path(tag_name: tag_list) %></span>
        <% end %>
    </p>
    <p class="article-text"><%= safe_join(@article.text.split("\n"), tag(:br)) %></p>

    <% if user_signed_in? %>
      <% if @article.favorited_by?(current_user) %>
        <p><%= link_to "いいね解除", article_favorites_path(@article), method: :delete %></p>
      <% else %>
        <p><%= link_to "いいねする", article_favorites_path(@article), method: :post %></p>
      <% end %>
    <% end %>

    <% if @article.user == current_user %>
      <%= link_to "編集する", edit_article_path(@article), class: "btn btn-default" %>
      <%= link_to "削除する", article_path(@article), class: "btn btn-default ", method: :delete, data: {confirm: "本当に削除してもよいですか？"} %>
    <% end %>
  </div>
</div>


<!-- 以下コメント機能 -->
<div class="row col-xs-10 col-xs-offset-1">
  <h3>コメント</h3>
  <div class="row col-xs-10 col-xs-offset-1">
    <% @article.article_comments.each do |article_comment| %>
      <div class="row comment">
        <div class="col-xs-1 text-right">
          <%= article_comment.user.name %>
        </div>
        <div class="col-xs-1">
          <%= link_to user_path(article_comment.user) do %>
            <%= attachment_image_tag article_comment.user, :profile_image, format: "jpeg", size: "60x60" %>
          <% end %>
        </div>
        <div class="col-xs-10">
          <%= safe_join(article_comment.comment.split("\n"), tag(:br)) %>
          <% if user_signed_in? %>
            <% if article_comment.user.id == current_user.id %>
              <%= link_to "コメントを削除", article_article_comment_path(@article, article_comment), method: :delete, class: "pull-right"%>
            <% end %>
          <% end %>
        </div>
      </div>
    <% end %>
  </div>

  <% if user_signed_in? %>
    <%= form_for [@article, @article_comment] do |f| %>
      <div class="row">
        <div class="col-xs-7 col-xs-offset-3 form-group">
          <%= f.text_area :comment, class: "form-control" %>
        </div>
        <div class="col-xs-2 from-group">
          <%= f.submit "コメントする", class: "btn-sm btn-default" %>
        </div>
      </div>
    <% end %>
  <% end %>
</div>